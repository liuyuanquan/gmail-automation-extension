# Gmail Automation Chrome Extension

è¿™æ˜¯ä¸€ä¸ª Chrome æ‰©å±•ç¨‹åºï¼Œå¯ä»¥å¸®åŠ©æ‚¨è‡ªåŠ¨å¡«å†™ Gmail é‚®ä»¶çš„æ”¶ä»¶äººã€ä¸»é¢˜ã€æ­£æ–‡å¹¶å‘é€é‚®ä»¶ã€‚æ”¯æŒæ‰¹é‡å‘é€å’Œ Excel æ•°æ®å¯¼å…¥ã€‚

## åŠŸèƒ½ç‰¹ç‚¹

- ğŸ“§ è‡ªåŠ¨å¡«å†™æ”¶ä»¶äººã€ä¸»é¢˜å’Œé‚®ä»¶æ­£æ–‡
- ğŸ“Š æ”¯æŒ Excel æ–‡ä»¶å¯¼å…¥ï¼Œæ‰¹é‡æå–æ”¶ä»¶äºº
- ğŸ“‹ æ”¯æŒé‚®ä»¶æ¨¡æ¿ï¼Œå¿«é€Ÿå¡«å……é‚®ä»¶å†…å®¹
- ğŸš€ æ‰¹é‡å‘é€é‚®ä»¶ï¼Œè‡ªåŠ¨å¤„ç†å¤šå°é‚®ä»¶
- ğŸ¨ ç°ä»£åŒ–çš„ UI ç•Œé¢ï¼ˆåŸºäº Vue 3 + Element Plusï¼‰
- âš¡ é€šè¿‡æµ®åŠ¨æŒ‰é’®å¿«é€Ÿè®¿é—®åŠŸèƒ½

## ğŸ“¦ é¡¹ç›®ç»“æ„

```
gmail-automation-extension/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ Overlay.vue          # Dialog è¦†ç›–å±‚ç»„ä»¶
â”‚   â”‚   â””â”€â”€ FloatingButton.vue   # æµ®åŠ¨æŒ‰é’®ç»„ä»¶
â”‚   â”œâ”€â”€ constants/
â”‚   â”‚   â””â”€â”€ index.js             # å¸¸é‡å®šä¹‰
â”‚   â”œâ”€â”€ stores/
â”‚   â”‚   â””â”€â”€ gmailStore.js         # Gmailç›¸å…³çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ delay.js              # å»¶è¿Ÿå‡½æ•°
â”‚   â”‚   â”œâ”€â”€ dom.js                # DOMæ“ä½œå·¥å…·
â”‚   â”‚   â”œâ”€â”€ excel.js              # Excelå¤„ç†å·¥å…·
â”‚   â”‚   â”œâ”€â”€ gmail.js              # Gmailç›¸å…³åŠŸèƒ½
â”‚   â”‚   â”œâ”€â”€ index.js              # å·¥å…·å‡½æ•°å…¥å£
â”‚   â”‚   â”œâ”€â”€ message.js            # æ¶ˆæ¯å¤„ç†
â”‚   â”‚   â”œâ”€â”€ template.js           # æ¨¡æ¿å¤„ç†
â”‚   â”‚   â”œâ”€â”€ templateLoader.js     # æ¨¡æ¿åŠ è½½å™¨
â”‚   â”‚   â””â”€â”€ time.js               # æ—¶é—´ç›¸å…³å·¥å…·
â”‚   â”œâ”€â”€ assets/
â”‚   â”‚   â”œâ”€â”€ main.css              # å…¨å±€æ ·å¼
â”‚   â”‚   â”œâ”€â”€ template15.html       # é‚®ä»¶æ¨¡æ¿
â”‚   â”‚   â””â”€â”€ template16.html       # é‚®ä»¶æ¨¡æ¿
â”‚   â”œâ”€â”€ App.vue                   # æ ¹ç»„ä»¶
â”‚   â””â”€â”€ app.js                    # åº”ç”¨å…¥å£æ–‡ä»¶
â”œâ”€â”€ public/                       # é™æ€èµ„æºç›®å½•ï¼ˆä¼šè¢«å¤åˆ¶åˆ° distï¼‰
â”‚   â”œâ”€â”€ manifest.json             # Chrome æ‰©å±•é…ç½®
â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â”œâ”€â”€ background.js         # èƒŒæ™¯è„šæœ¬
â”‚   â”‚   â””â”€â”€ xlsx.full.min.js      # XLSX åº“ï¼ˆå¤–éƒ¨ä¾èµ–ï¼‰
â”‚   â”œâ”€â”€ icons/                    # æ‰©å±•å›¾æ ‡
â”‚   â”‚   â”œâ”€â”€ icon128.png
â”‚   â”‚   â”œâ”€â”€ icon128.svg
â”‚   â”‚   â”œâ”€â”€ icon16.png
â”‚   â”‚   â”œâ”€â”€ icon16.svg
â”‚   â”‚   â”œâ”€â”€ icon48.png
â”‚   â”‚   â””â”€â”€ icon48.svg
â”‚   â””â”€â”€ templates/                # é‚®ä»¶æ¨¡æ¿æ–‡ä»¶
â”‚       â”œâ”€â”€ README.md
â”‚       â”œâ”€â”€ attachments/          # æ¨¡æ¿é™„ä»¶
â”‚       â”œâ”€â”€ config.json           # æ¨¡æ¿é…ç½®
â”‚       â”œâ”€â”€ template14.html
â”‚       â”œâ”€â”€ template15.html
â”‚       â””â”€â”€ template16.html
â”œâ”€â”€ package.json                  # é¡¹ç›®ä¾èµ–
â””â”€â”€ vite.config.js                # Vite é…ç½®
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
pnpm install
```

### 2. å¼€å‘æ¨¡å¼ï¼ˆç›‘å¬æ–‡ä»¶å˜åŒ–ï¼‰

```bash
npm run dev
```

### 3. æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
npm run build
```

æ„å»ºå®Œæˆåï¼Œæ–‡ä»¶ä¼šè¾“å‡ºåˆ° `dist/` ç›®å½•ã€‚

### 4. åŠ è½½æ‰©å±•

## âš ï¸ é‡è¦æç¤º

**å¿…é¡»åœ¨é¡¹ç›®æ ¹ç›®å½•åŠ è½½æ‰©å±•ï¼Œè€Œä¸æ˜¯ dist ç›®å½•ï¼**

### æ­£ç¡®æ­¥éª¤

1. æ‰“å¼€ Chrome æµè§ˆå™¨
2. è®¿é—® `chrome://extensions/`
3. å¼€å¯å³ä¸Šè§’çš„"å¼€å‘è€…æ¨¡å¼"ï¼ˆDeveloper modeï¼‰
4. ç‚¹å‡»"åŠ è½½å·²è§£å‹çš„æ‰©å±•ç¨‹åº"ï¼ˆLoad unpackedï¼‰
5. **é€‰æ‹©é¡¹ç›®æ ¹ç›®å½•**ï¼šä¾‹å¦‚ `d:\code\gmail-automation-extension`
   - âœ… æ­£ç¡®ï¼šé€‰æ‹©åŒ…å« `manifest.json` çš„ç›®å½•
   - âŒ é”™è¯¯ï¼šä¸è¦é€‰æ‹© `dist` ç›®å½•

### éªŒè¯

åŠ è½½æˆåŠŸåï¼Œä½ åº”è¯¥çœ‹åˆ°ï¼š

- âœ… æ‰©å±•åç§°ï¼šGmail Automation
- âœ… ç‰ˆæœ¬ï¼š1.0.2
- âœ… æ²¡æœ‰é”™è¯¯æç¤º

## ä½¿ç”¨æ–¹æ³•

1. æ‰“å¼€ Gmail ç½‘ç«™ (mail.google.com)
2. ç‚¹å‡»é¡µé¢å³ä¸‹è§’çš„æµ®åŠ¨æŒ‰é’®ï¼ˆğŸ“§ å›¾æ ‡ï¼‰
3. åœ¨å¼¹å‡ºç•Œé¢ä¸­ï¼š
   - é€‰æ‹©é‚®ä»¶æ¨¡æ¿ï¼ˆå¯é€‰ï¼‰
   - å¯¼å…¥ Excel æ–‡ä»¶ï¼ˆåŒ…å«æ”¶ä»¶äººé‚®ç®±ï¼‰
   - ç‚¹å‡»"å¼€å§‹å‘é€"æŒ‰é’®æ‰¹é‡å‘é€é‚®ä»¶
4. å¯ä»¥éšæ—¶ç‚¹å‡»"åœæ­¢å‘é€"æŒ‰é’®ä¸­æ–­å‘é€è¿‡ç¨‹

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **Vue 3** - æ¸è¿›å¼ JavaScript æ¡†æ¶
- **Element Plus** - Vue 3 UI ç»„ä»¶åº“
- **Vite** - ä¸‹ä¸€ä»£å‰ç«¯æ„å»ºå·¥å…·
- **Pinia** - Vue çŠ¶æ€ç®¡ç†åº“
- **Composition API** - Vue 3 ç»„åˆå¼ API

## ğŸ“ å¼€å‘è¯´æ˜

### çŠ¶æ€ç®¡ç†

ä½¿ç”¨ Pinia è¿›è¡ŒçŠ¶æ€ç®¡ç†ï¼Œä¸»è¦åŒ…å«ä¸€ä¸ª storeï¼š

**`gmailStore.js`** - Gmailç›¸å…³çŠ¶æ€ç®¡ç†ï¼Œå¤„ç†é‚®ä»¶å‘é€ã€æ¨¡æ¿åŠ è½½ç­‰æ ¸å¿ƒåŠŸèƒ½

### å·¥å…·å‡½æ•°

é¡¹ç›®ä¸­çš„å·¥å…·å‡½æ•°éƒ½ä½äº `utils/` ç›®å½•ä¸‹ï¼ŒåŒ…å«å¤šä¸ªä¸“ç”¨æ¨¡å—ï¼š
- `templateLoader.js` - è´Ÿè´£åŠ è½½å’Œç®¡ç†é‚®ä»¶æ¨¡æ¿
- `excel.js` - å¤„ç†Excelæ–‡ä»¶å¯¼å…¥å’Œæ•°æ®æå–
- `gmail.js` - Gmailé¡µé¢æ“ä½œç›¸å…³åŠŸèƒ½
- ä»¥åŠå…¶ä»–è¾…åŠ©å·¥å…·æ¨¡å—

### ç»„ä»¶

- `App.vue` - æ ¹ç»„ä»¶ï¼ŒåŒ…å« Overlay å’Œ FloatingButton
- `Overlay.vue` - Dialog ç»„ä»¶ï¼ŒåŒ…å«è¡¨å•å’Œæ“ä½œæŒ‰é’®
- `FloatingButton.vue` - æµ®åŠ¨æŒ‰é’®ç»„ä»¶ï¼Œæ”¯æŒæ‹–æ‹½å’Œç‚¹å‡»

## ğŸ”§ é…ç½®è¯´æ˜

### Vite é…ç½®

`vite.config.js` ä¸­é…ç½®äº†ï¼š

- Vue æ’ä»¶
- Element Plus è‡ªåŠ¨å¯¼å…¥
- æ„å»ºè¾“å‡ºç›®å½•ä¸º `dist`
- å…¥å£æ–‡ä»¶ä¸º `src/app.js`

### Manifest é…ç½®

`public/manifest.json` ä¸­é…ç½®äº†ï¼š

- Content Script æŒ‡å‘ `js/xlsx.full.min.js` å’Œ `js/content.js`
- é™æ€èµ„æºè·¯å¾„ï¼ˆiconsã€templatesã€pluginï¼‰
- æƒé™å’Œä¸»æœºæƒé™é…ç½®

## ğŸ“¦ æ„å»ºæµç¨‹

1. Vite ä¼šå°† `src/app.js` åŠå…¶ä¾èµ–æ‰“åŒ…åˆ° `dist/js/content.js`
2. Vue ç»„ä»¶ä¼šè¢«ç¼–è¯‘ä¸º JavaScript
3. Element Plus ç»„ä»¶ä¼šè‡ªåŠ¨å¯¼å…¥ï¼ˆé€šè¿‡ unplugin-vue-componentsï¼‰
4. Pinia stores ä¼šè¢«åŒ…å«åœ¨æ‰“åŒ…æ–‡ä»¶ä¸­
5. Composables å’Œå·¥å…·å‡½æ•°ä¼šè¢«æ‰“åŒ…
6. æ‰€æœ‰ä¾èµ–éƒ½ä¼šè¢«æ‰“åŒ…ï¼ˆé™¤äº†å¤–éƒ¨ä¾èµ–å¦‚ XLSXï¼‰
7. CSS ä¼šè¢«æå–åˆ° `dist/content.css`ï¼ˆå¦‚æœæœ‰ï¼‰
8. `public/` ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶ä¼šè‡ªåŠ¨å¤åˆ¶åˆ° `dist/` ç›®å½•
   - `manifest.json` â†’ `dist/manifest.json`
   - `js/xlsx.full.min.js` â†’ `dist/js/xlsx.full.min.js`
   - `icons/` â†’ `dist/icons/`
   - `templates/` â†’ `dist/templates/`
   - `plugin/` â†’ `dist/plugin/`

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **XLSX åº“**ï¼š`xlsx.full.min.js` éœ€è¦åœ¨ manifest.json ä¸­å•ç‹¬åŠ è½½ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªå…¨å±€åº“
2. **é™æ€èµ„æº**ï¼šæ‰€æœ‰é™æ€èµ„æºï¼ˆmanifest.jsonã€iconsã€templatesã€pluginï¼‰éƒ½æ”¾åœ¨ `public/` ç›®å½•ï¼Œæ„å»ºæ—¶ä¼šè‡ªåŠ¨å¤åˆ¶åˆ° `dist/`
3. **JS æ–‡ä»¶**ï¼šæ‰“åŒ…åçš„ JS æ–‡ä»¶ä¼šè¾“å‡ºåˆ° `dist/js/` ç›®å½•
4. **æ ·å¼éš”ç¦»**ï¼šç»„ä»¶æ ·å¼å·²åšä½œç”¨åŸŸé™åˆ¶ï¼Œä¸ä¼šå½±å“ Gmail é¡µé¢
5. **çŠ¶æ€æŒä¹…åŒ–**ï¼šå½“å‰çŠ¶æ€å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œåˆ·æ–°é¡µé¢ä¼šé‡ç½®
6. **Excel æ ¼å¼**ï¼šExcel æ–‡ä»¶éœ€è¦åŒ…å« `email` åˆ—ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰

## ğŸ› è°ƒè¯•

1. æ‰“å¼€ Chrome DevTools
2. åœ¨ Console ä¸­å¯ä»¥çœ‹åˆ°æ—¥å¿—è¾“å‡º
3. å®‰è£… Vue DevTools æ‰©å±•å¯ä»¥æŸ¥çœ‹ç»„ä»¶çŠ¶æ€

## æ•…éšœæ’é™¤

1. **æ‰©å±•æ— æ³•åŠ è½½**ï¼š

   - ç¡®ä¿å·²å¼€å¯å¼€å‘è€…æ¨¡å¼
   - ç¡®ä¿é€‰æ‹©äº†é¡¹ç›®æ ¹ç›®å½•ï¼ˆåŒ…å« `manifest.json` çš„ç›®å½•ï¼‰
   - ä¸è¦é€‰æ‹© `dist` ç›®å½•
   - ç¡®ä¿å·²è¿è¡Œ `npm run build` æ„å»ºé¡¹ç›®
   - ç¡®ä¿é¡¹ç›®æ ¹ç›®å½•ä¸­åŒ…å« `manifest.json` æ–‡ä»¶

2. **æ— æ³•å¡«å……é‚®ä»¶å­—æ®µ**ï¼š

   - ç¡®ä¿åœ¨ Gmail ç½‘ç«™ä¸Šä½¿ç”¨
   - åˆ·æ–°é¡µé¢åé‡è¯•
   - æ£€æŸ¥ Excel æ–‡ä»¶æ ¼å¼æ˜¯å¦æ­£ç¡®

3. **æ— æ³•å‘é€é‚®ä»¶**ï¼š
   - ç¡®ä¿æ‰€æœ‰å¿…å¡«å­—æ®µéƒ½å·²å¡«å†™
   - æ£€æŸ¥ç½‘ç»œè¿æ¥
   - ç¡®ä¿ Gmail è´¦æˆ·æ­£å¸¸ç™»å½•

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Vue 3 æ–‡æ¡£](https://vuejs.org/)
- [Element Plus æ–‡æ¡£](https://element-plus.org/)
- [Vite æ–‡æ¡£](https://vitejs.dev/)
- [Pinia æ–‡æ¡£](https://pinia.vuejs.org/)
- [Chrome Extension æ–‡æ¡£](https://developer.chrome.com/docs/extensions/)
